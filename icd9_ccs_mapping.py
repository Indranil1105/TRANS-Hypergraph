# icd9_to_ccs.py - ICD-9 to CCS Category Mapping

# Map ICD-9 code first 3 digits to CCS category number
# Reference: HCUP Clinical Classifications Software
ICD9_CCS_MAP = {
    # Infectious & Parasitic (001-139)
    '001': 1, '002': 1, '003': 1, '004': 1, '005': 1, '006': 2, '007': 2, '008': 2,
    '009': 3, '010': 4, '011': 4, '012': 4, '013': 4, '014': 4, '015': 4, '016': 4,
    
    # Neoplasms (140-239)
    '140': 11, '141': 11, '142': 11, '143': 11, '144': 11, '145': 11, '146': 11,
    '150': 12, '151': 13, '152': 14, '153': 14, '154': 14, '155': 15, '156': 16,
    '157': 16, '158': 17, '160': 18, '161': 18, '162': 18, '163': 18, '164': 18,
    '170': 19, '171': 19, '172': 20, '173': 20, '174': 21, '175': 21, '176': 22,
    '179': 23, '180': 24, '181': 24, '182': 24, '183': 25, '184': 26, '185': 27,
    '186': 28, '187': 29, '188': 30, '189': 30, '190': 31, '191': 32, '192': 33,
    
    # Endocrine & Metabolic (240-279)
    '240': 48, '241': 48, '242': 49, '244': 50, '245': 51, '246': 52, '250': 53,
    '251': 54, '252': 55, '253': 56, '254': 57, '255': 58, '256': 59, '257': 60,
    '258': 61, '259': 62, '260': 63, '261': 63, '262': 63, '263': 63, '264': 63,
    '265': 64, '266': 64, '267': 64, '268': 64, '269': 64, '270': 65, '271': 65,
    '272': 66, '273': 66, '274': 66, '275': 66, '276': 67, '277': 68, '278': 69,
    
    # Mental Disorders (290-319)
    '290': 659, '291': 660, '292': 661, '293': 662, '294': 663, '295': 664,
    '296': 665, '297': 666, '298': 667, '299': 668, '300': 669, '301': 670,
    '302': 671, '303': 660, '304': 661, '305': 662, '306': 663, '307': 664,
    
    # Nervous System (320-359)
    '320': 76, '321': 77, '322': 78, '323': 79, '324': 80, '325': 81, '330': 82,
    '331': 83, '332': 84, '333': 85, '334': 86, '335': 87, '336': 88, '337': 89,
    '338': 90, '340': 91, '341': 92, '342': 93, '343': 94, '344': 95, '345': 96,
    '346': 97, '347': 98, '348': 99, '349': 100, '350': 101, '351': 102, '352': 103,
    '353': 104, '354': 104, '355': 104, '356': 104, '357': 104, '358': 104,
    
    # Circulatory System (390-459)
    '390': 105, '391': 106, '392': 106, '393': 106, '394': 106, '395': 106,
    '396': 106, '397': 107, '398': 107, '399': 107, '401': 108, '402': 109,
    '403': 110, '404': 111, '405': 112, '410': 113, '411': 114, '412': 115,
    '413': 116, '414': 117, '415': 118, '416': 119, '417': 120, '420': 121,
    '421': 122, '422': 123, '423': 124, '424': 125, '425': 126, '426': 127,
    '427': 128, '428': 129, '429': 130, '430': 131, '431': 132, '432': 133,
    '433': 134, '434': 135, '435': 136, '436': 137, '437': 138, '438': 139,
    '440': 140, '441': 141, '442': 142, '443': 143, '444': 144, '445': 145,
    '446': 146, '447': 147, '451': 148, '452': 149, '453': 150, '454': 151,
    '455': 152, '456': 153, '457': 154, '458': 155, '459': 156,
    
    # Respiratory System (460-519)
    '460': 157, '461': 158, '462': 159, '463': 160, '464': 161, '465': 162,
    '466': 163, '470': 164, '471': 165, '472': 166, '473': 167, '474': 168,
    '475': 169, '476': 170, '477': 171, '478': 172, '480': 173, '481': 174,
    '482': 175, '483': 176, '484': 177, '485': 178, '486': 178, '487': 179,
    '488': 180, '490': 181, '491': 182, '492': 183, '493': 184, '494': 185,
    '495': 186, '496': 187, '500': 188, '501': 189, '502': 190, '503': 191,
    '504': 192, '505': 193, '506': 194, '507': 195, '508': 196, '509': 197,
    '510': 198, '511': 199, '512': 200, '513': 201, '514': 202, '515': 203,
    '516': 204, '517': 205, '518': 206, '519': 207,
    
    # Digestive System (520-579)
    '520': 208, '521': 209, '522': 210, '523': 211, '524': 212, '525': 213,
    '526': 214, '527': 215, '528': 216, '529': 217, '530': 218, '531': 219,
    '532': 220, '533': 221, '534': 222, '535': 223, '536': 224, '537': 225,
    '538': 226, '539': 227, '540': 228, '541': 229, '542': 230, '550': 231,
    '551': 232, '552': 233, '553': 234, '554': 235, '555': 236, '556': 237,
    '557': 238, '558': 239, '559': 240, '560': 241, '561': 242, '562': 243,
    '564': 244, '565': 245, '566': 246, '567': 247, '568': 248, '569': 249,
    '570': 250, '571': 251, '572': 252, '573': 253, '574': 254, '575': 255,
    '576': 256, '577': 257, '578': 258, '579': 259,
}

def icd9_to_ccs(code):
    """Convert ICD-9 code to CCS category number"""
    code_str = str(code)[:3]  # Take first 3 digits
    return ICD9_CCS_MAP.get(code_str, 999)  # 999 = unmapped

def is_valid_ccs(ccs_num):
    """Check if CCS number is valid (not unmapped)"""
    return ccs_num != 999